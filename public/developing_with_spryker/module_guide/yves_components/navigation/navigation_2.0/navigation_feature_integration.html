<!DOCTYPE html>
<html id="spryker-academy" lang="en-us" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Developing with Spryker|Module Guide|Yves Components|Navigation|Navigation 2.0">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0" />
        <meta name="author" content="Spryker Systems GmbH" />
        <meta name="title" content="Spryker Academy" />
        <meta name="msapplication-config" content="/resources/ui/images/favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="180x180" href="/resources/ui/images/favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="/resources/ui/images/favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="/resources/ui/images/favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="/resources/ui/images/favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="/resources/ui/images/favicons/favicon-16x16.png" /><title>Feature Integration - Navigation 2.*</title>
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <style>@import url('https://fonts.googleapis.com/css?family=Lato:300,400,400i,900');

</style>
        <link href="/resources/ui/css/academy-ui-typography.css" rel="stylesheet" />
        <link href="/resources/ui/css/academy-ui-app.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.expand-all-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.collapse-all-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../../../resources/ui/css/academy-ui-typography.css" rel="stylesheet" />
        <script src="../../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body class="t-base t-base--page js-base-template">
        <div class="t-base__header">
            <header class="o-header">
                <div class="o-header__content g-grid g-grid--container g-grid--middle"><a class="m-logo g-col g-col--sm-10 g-col--lg-2" href="/"><img class="m-logo__image" src="/resources/ui/images/logo.png" alt="Spryker Logo" /></a>
                    <nav class="m-nav-top g-col g-col--sm-2 g-col--lg-10" id="nav-top">
                        <div class="u-is-hidden--sm-xl">
                            <ul class="nocontent menu mc-component" data-mc-linked-toc="Data/Tocs/spryker_content.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                            </ul>
                        </div>
                        <div class="u-is-hidden--xl"><a class="m-nav-top__toggler js-base-template__toggler" href="#"><span class="icon icon-bars"></span></a>
                        </div>
                    </nav>
                </div>
            </header>
        </div>
        <div class="t-base__frame">
            <section class="o-search">
                <div class="g-grid g-grid--container">
                    <section class="m-search g-col g-col--sm-12">
                        <form action="/search.html" method="GET">
                            <input class="a-input a-input--expanded m-search__input" placeholder="Search in the Academy..." name="q" />
                            <button class="m-search__submit" type="submit"><span class="icon icon-search"></span>
                            </button>
                        </form>
                    </section>
                </div>
            </section>
            <section class="t-base__widgets g-grid g-grid--container g-grid--middle">
                <section class="m-breadcrumbs g-col g-col--sm-12 g-col--xl-8">
                    <div class="nocontent">
                        <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                        </div>
                    </div>
                </section>
                <div class="g-col g-col--sm-12 g-col--xl-4 u-align-right">
                    <section class="m-widget-toolbar">
                        <div class="buttons popup-container clearfix topicToolbarProxy _Skins_topic_toolbar mc-component nocontent">
                            <div class="button-group-container-left">
                                <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                    <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                </button>
                                <button class="button needs-pie next-topic-button" title="Navigate next">
                                    <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                </button>
                                <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                    <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                </button>
                                <button class="button needs-pie print-button" title="Print">
                                    <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                </button>
                            </div>
                        </div>
                    </section>
                    <div class="m-widget-github js-widget-github"><a class="m-widget-github__link icon icon-github js-widget-github__link" href="https://github.com/spryker/spryker-academy" target="_blank"></a>
                    </div>
                </div>
            </section>
            <main class="t-base__main g-grid g-grid--container">
                <div class="g-col g-col--sm-12 u-is-hidden--xl">
                    <div class="m-accordion js-accordion">
                        <div class="m-accordion__header">
                            <div class="m-accordion__title js-accordion__toggler"><span class="icon icon-ellipsis-v icon--left"></span>
                    Navigation
                </div>
                        </div>
                        <div class="m-accordion__content js-accordion__content">
                            <nav class="m-nav-sidebar" id="nav-sidebar">
                                <ul class="nocontent menu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/spryker_content.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
                <div class="t-page-sidebar__content o-content g-col g-col--sm-12 g-col--xl-8 js-anchorer js-highlighter js-widget-copy">
                    <h1>Feature Integration - Navigation 2.*</h1>
                    <h2>Prerequisites</h2>
                    <p>To prepare your project to work with Navigation:</p>
                    <ol>
                        <li value="1">Require the Navigation modules in your <var>composer.json</var>.</li>
                        <li value="2">Install the new database tables. By running <var>vendor/bin/console propel:diff</var>.Propel will generate a migration file with the changes.</li>
                        <li value="3">Apply the database changes: run <var>vendor/bin/console propel:migrate</var>.</li>
                        <li value="4">Generate ORM models: run <var>vendor/bin/console propel:model:build</var>.</li>
                        <li value="5">After running this command you’ll find some new classes in your project under <var>`\Orm\Zed\Navigation\Persistence`</var> namespace. </li>
                    </ol>
                    <p>It’s important to make sure that they extend the base classes from the Spryker core, e.g.:</p>
                    <ul>
                        <li class="bullet_list" value="1"><var>\Orm\Zed\Navigation\Persistence\SpyNavigation</var><strong> extends </strong><var>\Spryker\Zed\Navigation\Persistence\Propel\AbstractSpyNavigation</var>
                        </li>
                        <li class="bullet_list" value="2"><var>\Orm\Zed\Navigation\Persistence\SpyNavigationNode</var><strong> extends </strong><var>\Spryker\Zed\Navigation\Persistence\Propel\AbstractSpyNavigationNode</var>
                        </li>
                        <li class="bullet_list" value="3"><var>\Orm\Zed\Navigation\Persistence\SpyNavigationNodeLocalizedAttributes</var><strong> extends </strong><var>\Spryker\Zed\Navigation\Persistence\Propel\AbstractSpyNavigationNodeLocalizedAttributes</var>
                        </li>
                        <li class="bullet_list" value="4"><var>\Orm\Zed\Navigation\Persistence\SpyNavigationQuery</var><strong> extends </strong><var>\Spryker\Zed\Navigation\Persistence\Propel\AbstractSpyNavigationQuery</var>
                        </li>
                        <li class="bullet_list" value="5"><var>\Orm\Zed\Navigation\Persistence\SpyNavigationNodeQuery</var><strong> extends </strong><var>\Spryker\Zed\Navigation\Persistence\Propel\AbstractSpyNavigationNodeQuery</var>
                        </li>
                        <li class="bullet_list" value="6"><var>\Orm\Zed\Navigation\Persistence\SpyNavigationNodeLocalizedAttributesQuery</var><strong> extends </strong><var>\Spryker\Zed\Navigation\Persistence\Propel\AbstractSpyNavigationNodeLocalizedAttributesQuery</var>
                        </li>
                    </ul>
                    <ol start="6">
                        <li value="6">Run <var>vendor/bin/console transfer:generate</var> to get the new transfer objects.</li>
                        <li value="7">Make sure that the new Zed UI assets are also prepared for use by running the <code>npm run zed</code> command (or <var>antelope build zed </var>for older versions).</li>
                        <li value="8">To make the navigation management UI available in Zed navigation, run <var>vendor/bin/console application:build-navigation-cache</var> command.</li>
                        <li value="9">Activate the navigation menu collector by adding the <var>NavigationMenuCollectorStoragePlugin</var> to the storage collector plugin stack, see example below:</li>
                    </ol><pre><code class="bash">&lt;?php

namespace Pyz\Zed\Collector;

use Spryker\Shared\Navigation\NavigationConfig;
use Spryker\Zed\Kernel\Container;
use Spryker\Zed\NavigationCollector\Communication\Plugin\NavigationMenuCollectorStoragePlugin;
// ...

class CollectorDependencyProvider extends SprykerCollectorDependencyProvider
{
    /**
     * @param \Spryker\Zed\Kernel\Container $container
     *
     * @return \Spryker\Zed\Kernel\Container
     */
    public function provideBusinessLayerDependencies(Container $container)
    {
        // ...
       
        $container[self::STORAGE_PLUGINS] = function (Container $container) {
            return [
                // ...
                NavigationConfig::RESOURCE_TYPE_NAVIGATION_MENU =&gt; new NavigationMenuCollectorStoragePlugin(),
            ];
        };
        
        // ...
    }
}
</code></pre>
                    <h2>Data Setup</h2>
                    <p>You should now be able to manage navigation menus from Zed UI, and the collectors should also be able to export the navigation menus to the KV storage. This is a good time to implement an installer in your project to install a selection of frequently used navigation menus. Check out our <a href="https://github.com/spryker/demoshop" target="_blank">Demoshop implementation</a> for examples and ideas.</p>
                    <h2>Usage in Yves</h2>
                    <p>The KV storage should by now have some navigation menus we can display in our frontend.</p>
                    <p>The Navigation <span class="Generalbundle/module">module</span> ships with a twig extension that provides the <var>spyNavigation() </var>twig function which renders a navigation menu.</p>
                    <p><var>spyNavigation()</var> accepts two parameters:</p>
                    <ul>
                        <li class="bullet_list" value="1"><![CDATA[
]]><strong>$navigationKey</strong>: Reference of a navigation menu by its <var>key </var>field (i.e. <var>"MAIN_NAVIGATION"</var>).</li>
                        <li class="bullet_list" value="2"><strong>$template</strong>: Template path used to render the navigation menu (i.e. <var>"@application/layout/navigation/main.twig"</var>).</li>
                    </ul>
                    <p>To enable the navigation twig function register <var>\Spryker\Yves\Navigation\Plugin\Provider\NavigationTwigServiceProvider</var> in your application’s bootstrap.

</p><pre><code class="bash">&lt;?php

namespace Pyz\Yves\Application;

use Spryker\Yves\Navigation\Plugin\Provider\NavigationTwigServiceProvider;
// ...

class YvesBootstrap
{
    /**
     * @return void
     */
    protected function registerServiceProviders()
    {
        // ...
        $this-&gt;application-&gt;register(new NavigationTwigServiceProvider());
    }
}
</code></pre>
                    <p>Example of rendering navigation in a yves twig template:
</p><pre><code class="bash">{{ spyNavigation('MAIN_NAVIGATION', '@application/layout/navigation/main.twig') }}
</code></pre>
                    <h2>Rendering Navigation Templates</h2>
                    <p>The templates used to render a navigation menu use the navigationTree template variable to traverse the <var>navigation tree</var>. The variable contains an instance of <var>\Generated\Shared\Transfer\NavigationTreeTransfer </var>with only one localized attribute per node for the current locale.</p>
                    <p>The following code examples show the Demoshop implementation of how to render <var>MAIN_NAVIGATION</var> which is a multi-level navigation menu. For styling we used the <a href="http://foundation.zurb.com/sites/docs/menu.html" target="_blank">Menu</a> and <a href="http://foundation.zurb.com/sites/docs/dropdown.html" target="_blank">Dropdown</a> components from Foundation framework.</p>
                    <p>In <var>Pyz/Yves/Application/Theme/default/layout/navigation/main.twig</var> we traverse the root navigation nodes of the navigation tree and for each root node we render their children nodes as well.</p><pre><code class="bash">&lt;div class="callout show-for-large"&gt;
    &lt;div class="row"&gt;
        &lt;div class="large-12 columns"&gt;
            &lt;ul class="menu"&gt;
                {% for node in navigationTree.nodes %}
                    {% embed '@Application/layout/navigation/_partials/base-node.twig' %}
                        {% block url %}
                            &lt;li {% if node.children|length %}data-toggle="navigation-node-{{ node.navigationNode.idNavigationNode }}-children"{% endif %} class="{{ class }}"&gt;
                                &lt;a href="{{ url }}"&gt;{{ title }}&lt;/a&gt;
                            &lt;/li&gt;
                        {% endblock %}

                        {% block link %}
                            &lt;li {% if node.children|length %}data-toggle="navigation-node-{{ node.navigationNode.idNavigationNode }}-children"{% endif %} class="{{ class }}"&gt;
                                &lt;a href="{{ link  }}"&gt;{{ title }}&lt;/a&gt;
                            &lt;/li&gt;
                        {% endblock %}

                        {% block externalUrl %}
                            &lt;li {% if node.children|length %}data-toggle="navigation-node-{{ node.navigationNode.idNavigationNode }}-children"{% endif %} class="{{ class }}"&gt;
                                &lt;a href="{{ externalUrl }}" target="_blank"&gt;{{ title }}&lt;/a&gt;
                            &lt;/li&gt;
                        {% endblock %}

                        {% block other %}
                            &lt;li {% if node.children|length %}data-toggle="navigation-node-{{ node.navigationNode.idNavigationNode }}-children"{% endif %} class="menu-text {{ class }}"&gt;
                                {{ title }}
                            &lt;/li&gt;
                        {% endblock %}
                    {% endembed %}
                {% endfor %}
            &lt;/ul&gt;

            {% for node in navigationTree.nodes %}
                {% if node.navigationNode.isActive %}
                    {% if node.children|length %}
                        &lt;div class="dropdown-pane" id="navigation-node-{{ node.navigationNode.idNavigationNode }}-children" data-dropdown data-hover="true" data-hover-pane="true"&gt;
                            {% include '@Application/layout/navigation/_partials/nodes.twig' with {nodes: node.children} %}
                        &lt;/div&gt;
                    {% endif %}
                {% endif %}
            {% endfor %}
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>
                    <p>The children nodes are rendered recursively by <var>Pyz/Yves/Application/Theme/default/layout/navigation/_partials/nodes.twig</var>.

</p><pre><code class="bash">&lt;ul class="vertical menu {% if nested|default(false) %}nested{% endif %}"&gt;
    {% for node in nodes %}
        {% embed '@Application/layout/navigation/_partials/base-node.twig' %}
            {% block nodeContainer %}
                &lt;li id="navigation-node-{{ node.navigationNode.idNavigationNode }}" data-id-navigation-node="{{ node.navigationNode.idNavigationNode }}" class="{{ class }}"&gt;
                    {{ parent() }}

                    {% if node.children|length %}
                        {% include '@Application/layout/navigation/_partials/nodes.twig' with {nodes: node.children, nested:true} %}
                    {% endif %}
                &lt;/li&gt;
            {% endblock %}

            {% block url %}
                &lt;a href="{{ url }}"&gt;{{ title }}&lt;/a&gt;
            {% endblock %}

            {% block link %}
                &lt;a href="{{ link }}"&gt;{{ title }}&lt;/a&gt;
            {% endblock %}

            {% block externalUrl %}
                &lt;a href="{{ externalUrl }}" target="_blank"&gt;{{ title }}&lt;/a&gt;
            {% endblock %}

            {% block other %}
                &lt;span class="menu-text"&gt;{{ title }}&lt;/span&gt;
            {% endblock %}
        {% endembed %}
    {% endfor %}
&lt;/ul&gt;
</code></pre>
                    <p>To prevent code duplication we implemented the <var>Pyz/Yves/Application/Theme/default/layout/navigation/_partials/base-node.twig</var> template which we use to render a node by embedding it in the templates above.</p>
                    <p>This is also the place where we take the visibility controller parameters into account : <var>valid_from</var>, <var>valid_to</var>, <var>is_active</var>.</p><pre><code class="bash">{% set class = node.navigationNode.navigationNodeLocalizedAttributes[0].cssClass %}
{% set url = node.navigationNode.navigationNodeLocalizedAttributes[0].url %}
{% set externalUrl = node.navigationNode.navigationNodeLocalizedAttributes[0].externalUrl %}
{% set link = node.navigationNode.navigationNodeLocalizedAttributes[0].link %}
{% set title = node.navigationNode.navigationNodeLocalizedAttributes[0].title %}
{% set today = "now"|date("Ymd") %}

{% if node.navigationNode.isActive and
    (node.navigationNode.validFrom is empty or node.navigationNode.validFrom|date("Ymd") ‹= today) and
    (node.navigationNode.validTo is empty or node.navigationNode.validTo|date("Ymd") &gt;= today)
%}
    {% block nodeContainer %}
        {% if url %}
            {% block url %}{% endblock %}
        {% elseif link %}
            {% block link %}{% endblock %}
        {% elseif externalUrl %}
            {% block externalUrl %}{% endblock %}
        {% else %}
            {% block other %}{% endblock %}
        {% endif %}
    {% endblock %}
{% endif %}
</code></pre>
                    <p>&#160;</p>
                    <p><b>See also:</b>
                    </p>
                    <ul>
                        <li value="1"><a href="../navigation.html" class="MCXref xref">Navigation</a>
                        </li>
                        <li value="2"><a href="navigation_under_the_hood.html" class="MCXref xref">Under the Hood - Navigation 2.*</a>
                        </li>
                        <li value="3"><a href="../../../../migration_guides/mg_navigation.html" class="MCXref xref">Migration Guide - Navigation Module</a>
                        </li>
                        <li value="4"><a href="../../../../migration_guides/mg_navigation.html" class="MCXref xref">Migration Guide - Navigation Module</a>
                        </li>
                    </ul>
                    <p>&#160;</p>
                    <p><![CDATA[
		]]><i>Last review date: Sep. 21st, 2017 </i><![CDATA[    ]]></p>
                </div>
                <div class="t-page-sidebar__sidebar g-col g-col--sm-12 g-col--xl-4 u-is-hidden--sm-xl">
                    <section class="a-box a-box--shadow">
                        <nav class="m-nav-sidebar" id="nav-sidebar">
                            <ul class="nocontent menu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/spryker_content.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                            </ul>
                        </nav>
                    </section>
                </div>
            </main>
            <div class="t-base__footer">
                <footer class="o-footer g-grid g-grid--middle">
                    <nav class="g-grid g-grid--container g-grid--center"><a class="o-footer__link" href="https://spryker.com/privacy-policy" target="_blank">Privacy policy</a><a class="o-footer__link" href="https://spryker.com/partneragb" target="_blank">AGB Partnerprogram</a><a class="o-footer__link" href="https://spryker.com/impressum" target="_blank">Impressum</a>
                    </nav>
                </footer>
            </div><a class="a-scroll-top js-scroll-top" href="#"><span class="a-scroll-top__icon icon icon-chevron-up"></span></a>
            <div class="t-base__overlay js-base-template__toggler">
            </div>
        </div>
        <div class="t-base__off">
            <section class="o-off-canvas">
                <nav class="m-nav-mobile" id="nav-mobile">
                    <ul class="nocontent menu mc-component" data-mc-linked-toc="Data/Tocs/spryker_content.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                    </ul>
                </nav>
            </section>
        </div>
        <script src="/resources/ui/js/academy-ui-manifest.js">
        </script>
        <script src="/resources/ui/js/academy-ui-vendor.js">
        </script>
        <script src="/resources/ui/js/academy-ui-app.js">
        </script>
        <script>/* <![CDATA[ */
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-56589105-2', 'auto');
        ga('send', 'pageview');
    /* ]]> */</script>
        <script type="text/javascript" id="hs-script-loader" src="//js.hs-scripts.com/2770802.js">
        </script>
    </body>
</html>